<?xml version="1.0" encoding="UTF-8"?>
<exp:Export Version="3.0"
    xmlns:L7p="http://www.layer7tech.com/ws/policy"
    xmlns:exp="http://www.layer7tech.com/ws/policy/export" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <exp:References>
        <IncludedPolicyReference
            RefType="com.l7tech.console.policy.exporter.IncludedPolicyReference"
            guid="9b24fba0-6ba9-4c94-9d2b-04f611c4ff46" included="true"
            name="Legacy - Escaper" soap="false" type="INCLUDE_FRAGMENT">
            <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
                <wsp:All wsp:Usage="Required">
                    <L7p:CommentAssertion>
                        <L7p:Comment stringValue="*************************************************************************"/>
                    </L7p:CommentAssertion>
                    <L7p:CommentAssertion>
                        <L7p:Comment stringValue="**Legacy  Escaper"/>
                    </L7p:CommentAssertion>
                    <L7p:CommentAssertion>
                        <L7p:Comment stringValue="** "/>
                    </L7p:CommentAssertion>
                    <L7p:CommentAssertion>
                        <L7p:Comment stringValue="** Escape request/response used by regular expession"/>
                    </L7p:CommentAssertion>
                    <L7p:CommentAssertion>
                        <L7p:Comment stringValue="** "/>
                    </L7p:CommentAssertion>
                    <L7p:CommentAssertion>
                        <L7p:Comment stringValue="*************************************************************************"/>
                    </L7p:CommentAssertion>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="Policy Fragment: Legacy - Escaper"/>
                    </L7p:AuditDetailAssertion>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkucmV0dXJuX3ZhbHVlfQ=="/>
                        <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                        <L7p:DataType variableDataType="message"/>
                        <L7p:Enabled booleanValue="false"/>
                        <L7p:VariableToSet stringValue="responseOut"/>
                    </L7p:SetVariable>
                    <L7p:Regex>
                        <L7p:AutoTarget booleanValue="false"/>
                        <L7p:OtherTargetMessageVariable stringValue="responseOut"/>
                        <L7p:Regex stringValue="&amp;"/>
                        <L7p:RegexName stringValue="Replace &amp; with &amp;amp;"/>
                        <L7p:Replace booleanValue="true"/>
                        <L7p:Replacement stringValue="&amp;amp;"/>
                        <L7p:Target target="OTHER"/>
                    </L7p:Regex>
                    <L7p:Regex>
                        <L7p:AutoTarget booleanValue="false"/>
                        <L7p:OtherTargetMessageVariable stringValue="responseOut"/>
                        <L7p:Regex stringValue="&quot;"/>
                        <L7p:RegexName stringValue="Replace &quot; with &amp;quot;"/>
                        <L7p:Replace booleanValue="true"/>
                        <L7p:Replacement stringValue="&amp;quot;"/>
                        <L7p:Target target="OTHER"/>
                    </L7p:Regex>
                    <L7p:Regex>
                        <L7p:AutoTarget booleanValue="false"/>
                        <L7p:OtherTargetMessageVariable stringValue="responseOut"/>
                        <L7p:Regex stringValue="'"/>
                        <L7p:RegexName stringValue="Replace ' with &amp;apos;"/>
                        <L7p:Replace booleanValue="true"/>
                        <L7p:Replacement stringValue="&amp;apos;"/>
                        <L7p:Target target="OTHER"/>
                    </L7p:Regex>
                    <L7p:Regex>
                        <L7p:AutoTarget booleanValue="false"/>
                        <L7p:OtherTargetMessageVariable stringValue="responseOut"/>
                        <L7p:Regex stringValue="&lt;"/>
                        <L7p:RegexName stringValue="Replace &lt; with &amp;lt;"/>
                        <L7p:Replace booleanValue="true"/>
                        <L7p:Replacement stringValue="&amp;lt;"/>
                        <L7p:Target target="OTHER"/>
                    </L7p:Regex>
                    <L7p:Regex>
                        <L7p:AutoTarget booleanValue="false"/>
                        <L7p:OtherTargetMessageVariable stringValue="responseOut"/>
                        <L7p:Regex stringValue=">"/>
                        <L7p:RegexName stringValue="Replace > with &amp;gt;"/>
                        <L7p:Replace booleanValue="true"/>
                        <L7p:Replacement stringValue="&amp;gt;"/>
                        <L7p:Target target="OTHER"/>
                    </L7p:Regex>
                    <L7p:HardcodedResponse>
                        <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZU91dC5tYWlucGFydH0="/>
                        <L7p:Enabled booleanValue="false"/>
                    </L7p:HardcodedResponse>
                </wsp:All>
            </wsp:Policy>
        </IncludedPolicyReference>
        <JdbcConnectionReference RefType="com.l7tech.console.policy.exporter.JdbcConnectionReference">
            <ConnectionName>Tracer Database</ConnectionName>
            <DriverClass>com.l7tech.jdbc.oracle.OracleDriver</DriverClass>
            <JdbcUrl>jdbc:l7tech:oracle://it1dev01:1521;SID=ifdev1</JdbcUrl>
            <UserName>IFRT_A</UserName>
        </JdbcConnectionReference>
        <RemoteCacheReference RefType="com.l7tech.external.assertions.remotecacheassertion.RemoteCacheReference">
            <OID>11567104</OID>
            <Name>RemoteCache</Name>
            <Classname>com.l7tech.external.assertions.remotecacheassertion.RemoteCacheEntity</Classname>
            <Type>memcached</Type>
            <Timeout>1</Timeout>
            <Properties>
                <Property mame="ports">vmesbdev1:23000</Property>
                <Property mame="bucketSpecified">false</Property>
            </Properties>
        </RemoteCacheReference>
        <JdbcConnectionReference RefType="com.l7tech.console.policy.exporter.JdbcConnectionReference">
            <ConnectionName>${config.connection}</ConnectionName>
        </JdbcConnectionReference>
    </exp:References>
    <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="*************************************************************************"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="** Legacy IF Service as HTTP Request"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="** "/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="** HTTP service to invoke legacy services"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="** "/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="** v0.0.0 - 20130214 - Daniel Haviv"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="** v1.0- 6-jun-2013 _STUB treatment added"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="*************************************************************************"/>
            </L7p:CommentAssertion>
            <L7p:AuditAssertion/>
            <L7p:AuditDetailAssertion>
                <L7p:Detail stringValueReference="inline"><![CDATA[Parameters:
request.http.method=${request.http.method} 
action: "${request.http.parameter.action}"
timeout: "${request.http.parameter.timeout}"
xmlRequest: "${request.http.parameter.xmlRequest}"
serviceName: "${request.http.parameter.serviceName}"
reqOrigin: "${request.http.parameter.reqOrigin}"
reqOriginApp: "${request.http.parameter.reqOriginApp}"
reqOriginator: "${request.http.parameter.reqOriginator}"]]></L7p:Detail>
            </L7p:AuditDetailAssertion>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.parameters.action}"/>
                        <L7p:FailIfVariableNotFound booleanValue="false"/>
                        <L7p:MultivaluedComparison multivaluedComparison="FIRST"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="SendReceive"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="Inside SR"/>
                    </L7p:AuditDetailAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.serviceName}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.stub}"/>
                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="boolean"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="true"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="X1NUVUI="/>
                                    <L7p:VariableToSet stringValue="stub"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue=" // Handle stub=true"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="stub"/>
                                </L7p:SetVariable>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue=" // If a stub, route to the stub service"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:OneOrMore>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="Escape the input XML"/>
                            </L7p:CommentAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnhtbFJlcXVlc3R9"/>
                                <L7p:VariableToSet stringValue="responseOut"/>
                            </L7p:SetVariable>
                            <L7p:Include>
                                <L7p:PolicyGuid stringValue="9b24fba0-6ba9-4c94-9d2b-04f611c4ff46"/>
                            </L7p:Include>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.timeout}"/>
                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    <L7p:item regex="included">
                                    <L7p:Pattern stringValue="^\d+$"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PGNvbnN1bWVyVGltZW91dD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIudGltZW91dH08L2NvbnN1bWVyVGltZW91dD4="/>
                                    <L7p:VariableToSet stringValue="timeoutElement"/>
                                    </L7p:SetVariable>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="timeoutElement"/>
                                </L7p:SetVariable>
                            </wsp:OneOrMore>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8c2VyOkludm9rZT4NCiAgICAgICAgIDxzZXJ2aWNlTmFtZT4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuc2VydmljZU5hbWV9PC9zZXJ2aWNlTmFtZT4NCiAgICAgICAgIDwhLS1Zb3UgaGF2ZSBhIENIT0lDRSBvZiB0aGUgbmV4dCAyIGl0ZW1zIGF0IHRoaXMgbGV2ZWwtLT4NCiAgICAgICAgIDxpbnZvY2F0aW9uUGFyYW1ldGVycz4NCiAgICAgICAgICAgIDwhLS1PcHRpb25hbDotLT4NCiAgICAgICAgICAgIDxhc3luYz4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuYXN5bmN9PC9hc3luYz4NCgkgICAgPGZvcmNlU3luYz4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuZm9yY2VTeW5jfTwvZm9yY2VTeW5jPg0KICAgICAgICAgICAgPGFyZ3VtZW50cz4NCiAgICAgICAgICAgICAgIDxpbnB1dD4ke3Jlc3BvbnNlT3V0fTwvaW5wdXQ+DQogICAgICAgICAgICA8L2FyZ3VtZW50cz4NCiAgICAgICAgICAgICR7dGltZW91dEVsZW1lbnR9DQogICAgICAgICAgICA8cmVxT3JpZ2luPiR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5yZXFPcmlnaW59PC9yZXFPcmlnaW4+DQogICAgICAgICAgICA8cmVxT3JpZ2luQXBwPiR7cmVxdWVzdC5odHRwLnBhcmFtZXRlci5yZXFPcmlnaW5BcHB9PC9yZXFPcmlnaW5BcHA+DQogICAgICAgICAgICA8cmVxT3JpZ2luYXRvcj4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIucmVxT3JpZ2luYXRvcn08L3JlcU9yaWdpbmF0b3I+DQogICAgICAgICA8L2ludm9jYXRpb25QYXJhbWV0ZXJzPg0KICAgICAgPC9zZXI6SW52b2tlPg0KICAgPC9zb2FwZW52OkJvZHk+DQo8L3NvYXBlbnY6RW52ZWxvcGU+"/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="XMLRequest"/>
                            </L7p:SetVariable>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="Route the request wrapped in a SOAP message to the legacy service"/>
                            </L7p:CommentAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="JHt4bWxSZXF1ZXN0Lm1haW5wYXJ0fQ=="/>
                                <L7p:EarlyResponse booleanValue="true"/>
                                <L7p:Enabled booleanValue="false"/>
                                <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                            </L7p:HardcodedResponse>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.timeout}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item stringLength="included">
                                    <L7p:Max intValue="-1"/>
                                    <L7p:Min intValue="2"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRpbWVvdXR9MDAw"/>
                                    <L7p:DataType variableDataType="int"/>
                                    <L7p:VariableToSet stringValue="consumerTimeout"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// Check if a timeout parameter is passed by the request."/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// if the above is not set then use default setting from system"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:AssertionComment>
                                    <L7p:Base64Expression stringValue="JHtnYXRld2F5LnBhcnRuZXIuY29uZmlndXJhdGlvbi5jb25zdW1lclRpbWVvdXR9MDAw"/>
                                    <L7p:DataType variableDataType="int"/>
                                    <L7p:VariableToSet stringValue="consumerTimeout"/>
                                </L7p:SetVariable>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// checks what consumerTimeout to use for the HTTP assertion"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:OneOrMore>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="CONSUMERTIMEOUT=${consumerTimeout}"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="${xmlrequest.mainpart}"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:HttpRoutingAssertion>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue=" // using consumerTimeout here"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${request.http.parameter.serviceName}${stub}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="responseMsg"/>
                                <L7p:SamlAssertionVersion intValue="2"/>
                                <L7p:Timeout stringValue="${consumertimeout}"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="Pull the response out of the response XML message"/>
                            </L7p:CommentAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0="/>
                                <L7p:Enabled booleanValue="false"/>
                            </L7p:HardcodedResponse>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="** disabled above and added return below for testing"/>
                            </L7p:CommentAssertion>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="** Checking if there is a response or not"/>
                            </L7p:CommentAssertion>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="** if there is not, then trigger the receive action"/>
                            </L7p:CommentAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="response: ${responseMsg.mainpart}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue=""/>
                                    <L7p:XmlMsgSrc stringValue="responseMsg"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/eta/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="ser"/>
                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="eta found at ${responsexpath.result}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:CommentAssertion>
                                    <L7p:Comment stringValue="*** Calling the Receive action."/>
                                    </L7p:CommentAssertion>
                                    <L7p:HttpRoutingAssertion>
                                    <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/?action=Receive&amp;RequestID=${request.http.parameter.requestid}"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="responseMsg"/>
                                    <L7p:SamlAssertionVersion intValue="2"/>
                                    </L7p:HttpRoutingAssertion>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// check for ETA and if so use receive"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue=""/>
                                    <L7p:XmlMsgSrc stringValue="responseMsg"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/response/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="ser"/>
                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZU1zZy5tYWlucGFydH0="/>
                                    <L7p:Enabled booleanValue="false"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0="/>
                                    </L7p:HardcodedResponse>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// if not ETA, return response"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// check if there is a response or not"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:OneOrMore>
                        </wsp:All>
                        <L7p:HardcodedResponse>
                            <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlcnZpY2VOYW1lfTwvU0VSVklDRV9OQU1FPjxSRVFVRVNUX1NUQVRVUz48U1RBVFVTPkVSUk9SPC9TVEFUVVM+PFNUQVRVU19DT0RFPi0xPC9TVEFUVVNfQ09ERT48U1RBVFVTX01FU1NBR0U+Q291bGQgbm90IHBlcmZvcm0gcmVxdWVzdC48L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                        </L7p:HardcodedResponse>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="SendReceive Action"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.parameter.action}"/>
                        <L7p:FailIfVariableNotFound booleanValue="false"/>
                        <L7p:MultivaluedComparison multivaluedComparison="FIRST"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="Send"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="Seems like a send"/>
                        <L7p:Level stringValue="WARNING"/>
                    </L7p:AuditDetailAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All L7p:Enabled="false" wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Enabled booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.serviceName}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8c2VyOkludm9rZT4NCiAgICAgICAgIDxzZXJ2aWNlTmFtZT4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuc2VydmljZW5hbWV9PC9zZXJ2aWNlTmFtZT4NCiAgICAgICAgIDwhLS1Zb3UgaGF2ZSBhIENIT0lDRSBvZiB0aGUgbmV4dCAyIGl0ZW1zIGF0IHRoaXMgbGV2ZWwtLT4NCiAgICAgICAgICAgICAgICAgIDxpbnZvY2F0aW9uUGFyYW1ldGVycz4NCiAgICAgICAgICAgIDwhLS1PcHRpb25hbDotLT4NCiAgICAgICAgICAgIDxhc3luYz50cnVlPC9hc3luYz4NCiAgICAgICAgICAgIDxhcmd1bWVudHM+DQogICAgICAgICAgICAgICA8aW5wdXQ+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnhtbFJlcXVlc3R9PC9pbnB1dD4NCiAgICAgICAgICAgIDwvYXJndW1lbnRzPg0KICAgICAgICAgICAgPCEtLU9wdGlvbmFsOi0tPg0KICAgICAgICAgICAgPHNsZWVwPj88L3NsZWVwPg0KICAgICAgICAgICAgPCEtLU9wdGlvbmFsOi0tPg0KICAgICAgICAgICAgPGNhY2hlVFRMPj88L2NhY2hlVFRMPg0KICAgICAgICAgICAgPCEtLU9wdGlvbmFsOi0tPg0KICAgICAgICAgICAgPGNhbGxiYWNrU2VydmljZU5hbWU+PzwvY2FsbGJhY2tTZXJ2aWNlTmFtZT4NCiAgICAgICAgICAgIDwhLS1PcHRpb25hbDotLT4NCiAgICAgICAgICAgIDxjb3JyZWxhdGlvbkluZm8+DQogICAgICAgICAgICAgICA8Y29ycmVsYXRpb25JZD4/PC9jb3JyZWxhdGlvbklkPg0KICAgICAgICAgICAgICAgPCEtLU9wdGlvbmFsOi0tPg0KICAgICAgICAgICAgICAgPGV4dGVybmFsSWQ+PzwvZXh0ZXJuYWxJZD4NCiAgICAgICAgICAgIDwvY29ycmVsYXRpb25JbmZvPg0KICAgICAgICAgPC9pbnZvY2F0aW9uUGFyYW1ldGVycz4NCiAgICAgIDwvc2VyOkludm9rZT4NCiAgIDwvc29hcGVudjpCb2R5Pg0KPC9zb2FwZW52OkVudmVsb3BlPg=="/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:Enabled booleanValue="false"/>
                                <L7p:VariableToSet stringValue="XMLRequest"/>
                            </L7p:SetVariable>
                            <L7p:HttpRoutingAssertion>
                                <L7p:Enabled booleanValue="false"/>
                                <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${request.http.parameter.serviceName}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="responseMsg"/>
                                <L7p:SamlAssertionVersion intValue="2"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:ResponseXpathAssertion>
                                <L7p:Enabled booleanValue="false"/>
                                <L7p:VariablePrefix stringValue=""/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:InvokeResponse/response/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="ser"/>
                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0="/>
                                <L7p:Enabled booleanValue="false"/>
                            </L7p:HardcodedResponse>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Old Send "/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="inside daniel's send"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.serviceName}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="Escape the input XML"/>
                            </L7p:CommentAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnhtbFJlcXVlc3R9"/>
                                <L7p:VariableToSet stringValue="responseOut"/>
                            </L7p:SetVariable>
                            <L7p:Include>
                                <L7p:PolicyGuid stringValue="9b24fba0-6ba9-4c94-9d2b-04f611c4ff46"/>
                            </L7p:Include>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.timeout}"/>
                                    <L7p:FailIfVariableNotFound booleanValue="false"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    <L7p:item regex="included">
                                    <L7p:Pattern stringValue="^\d+$"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PGNvbnN1bWVyVGltZW91dD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIudGltZW91dH08L2NvbnN1bWVyVGltZW91dD4="/>
                                    <L7p:VariableToSet stringValue="timeoutElement"/>
                                    </L7p:SetVariable>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue=""/>
                                    <L7p:VariableToSet stringValue="timeoutElement"/>
                                </L7p:SetVariable>
                            </wsp:OneOrMore>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8c2VyOkludm9rZT4NCiAgICAgICAgIDxzZXJ2aWNlTmFtZT4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuc2VydmljZU5hbWV9PC9zZXJ2aWNlTmFtZT4NCiAgICAgICAgIDwhLS1Zb3UgaGF2ZSBhIENIT0lDRSBvZiB0aGUgbmV4dCAyIGl0ZW1zIGF0IHRoaXMgbGV2ZWwtLT4NCiAgICAgICAgIDxpbnZvY2F0aW9uUGFyYW1ldGVycz4NCiAgICAgICAgICAgIDwhLS1PcHRpb25hbDotLT4NCiAgICAgICAgICAgIDxhc3luYz50cnVlPC9hc3luYz4NCiAgICAgICAgICAgIDxhcmd1bWVudHM+DQogICAgICAgICAgICAgICA8aW5wdXQ+JHtyZXNwb25zZU91dH08L2lucHV0Pg0KICAgICAgICAgICAgPC9hcmd1bWVudHM+DQogICAgICAgICAgICAke3RpbWVvdXRFbGVtZW50fQ0KICAgICAgICAgICAgPHJlcU9yaWdpbj4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIucmVxT3JpZ2lufTwvcmVxT3JpZ2luPg0KICAgICAgICAgICAgPHJlcU9yaWdpbkFwcD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIucmVxT3JpZ2luQXBwfTwvcmVxT3JpZ2luQXBwPg0KICAgICAgICAgICAgPHJlcU9yaWdpbmF0b3I+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlcU9yaWdpbmF0b3J9PC9yZXFPcmlnaW5hdG9yPg0KICAgICAgICAgPC9pbnZvY2F0aW9uUGFyYW1ldGVycz4NCiAgICAgIDwvc2VyOkludm9rZT4NCiAgIDwvc29hcGVudjpCb2R5Pg0KPC9zb2FwZW52OkVudmVsb3BlPg=="/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="XMLRequest"/>
                            </L7p:SetVariable>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="Route the request wrapped in a SOAP message to the legacy service"/>
                            </L7p:CommentAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.timeout}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item stringLength="included">
                                    <L7p:Max intValue="-1"/>
                                    <L7p:Min intValue="2"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRpbWVvdXR9"/>
                                    <L7p:VariableToSet stringValue="consumerTimeout"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// Check if a timeout parameter is passed by the request."/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// if the above is not set then use default setting from system"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:AssertionComment>
                                    <L7p:Base64Expression stringValue="JHtnYXRld2F5LnBhcnRuZXIuY29uZmlndXJhdGlvbi5jb25zdW1lclRpbWVvdXR9"/>
                                    <L7p:VariableToSet stringValue="consumerTimeout"/>
                                </L7p:SetVariable>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// checks what consumerTimeout to use for the HTTP assertion"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:OneOrMore>
                            <L7p:HttpRoutingAssertion>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue=" // using consumerTimeout here"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${request.http.parameter.serviceName}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="responseMsg"/>
                                <L7p:SamlAssertionVersion intValue="2"/>
                                <L7p:Timeout stringValue="300000"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:CommentAssertion>
                                <L7p:Comment stringValue="Pull the response out of the response XML message"/>
                            </L7p:CommentAssertion>
                            <L7p:ResponseXpathAssertion>
                                <L7p:VariablePrefix stringValue=""/>
                                <L7p:XmlMsgSrc stringValue="responseMsg"/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/requestId"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="ser"/>
                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPgogIDxTRVJWSUNFX05BTUU+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlcnZpY2VOYW1lfTwvU0VSVklDRV9OQU1FPiAKICA8UkVRVUVTVF9TVEFUVVM+CiAgICA8U1RBVFVTPlNVQ0NFU1M8L1NUQVRVUz4gCiAgICA8U1RBVFVTX0NPREU+MDwvU1RBVFVTX0NPREU+IAogICAgPFNUQVRVU19NRVNTQUdFIC8+IAogIDwvUkVRVUVTVF9TVEFUVVM+CiAgPFJFUVVFU1RfSUQ+JHtyZXNwb25zZVhwYXRoLnJlc3VsdH08L1JFUVVFU1RfSUQ+IAo8L0lGX1JFUExZPg=="/>
                                <L7p:EarlyResponse booleanValue="true"/>
                            </L7p:HardcodedResponse>
                        </wsp:All>
                        <L7p:HardcodedResponse>
                            <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlcnZpY2VOYW1lfTwvU0VSVklDRV9OQU1FPjxSRVFVRVNUX1NUQVRVUz48U1RBVFVTPkVSUk9SPC9TVEFUVVM+PFNUQVRVU19DT0RFPi0xPC9TVEFUVVNfQ09ERT48U1RBVFVTX01FU1NBR0U+Q291bGQgbm90IHBlcmZvcm0gcmVxdWVzdC48L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                        </L7p:HardcodedResponse>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="Send Action"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.parameters.action}"/>
                        <L7p:FailIfVariableNotFound booleanValue="false"/>
                        <L7p:MultivaluedComparison multivaluedComparison="FIRST"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="Receive"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:OneOrMore L7p:Enabled="false" wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Enabled booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.requestID}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+PC9TRVJWSUNFX05BTUU+PFJFUVVFU1RfU1RBVFVTPjxTVEFUVVM+RVJST1I8L1NUQVRVUz48U1RBVFVTX0NPREU+LTE8L1NUQVRVU19DT0RFPjxTVEFUVVNfTUVTU0FHRT5QYXJhbWV0ZXIgcmVxdWVzdElEIGlzIHJlcXVpcmVkLjwvU1RBVFVTX01FU1NBR0U+PC9SRVFVRVNUX1NUQVRVUz48L0lGX1JFUExZPg=="/>
                                <L7p:Enabled booleanValue="false"/>
                            </L7p:HardcodedResponse>
                        </wsp:OneOrMore>
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.requestID}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+PC9TRVJWSUNFX05BTUU+PFJFUVVFU1RfU1RBVFVTPjxTVEFUVVM+RVJST1I8L1NUQVRVUz48U1RBVFVTX0NPREU+LTE8L1NUQVRVU19DT0RFPjxTVEFUVVNfTUVTU0FHRT5QYXJhbWV0ZXIgcmVxdWVzdElEIGlzIHJlcXVpcmVkLjwvU1RBVFVTX01FU1NBR0U+PC9SRVFVRVNUX1NUQVRVUz48L0lGX1JFUExZPg=="/>
                            </L7p:HardcodedResponse>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="Getting info from localhost http://localhost:8080/LegacyGetServiceName?requestID=${request.http.parameter.requestID}"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:HttpRoutingAssertion>
                                <L7p:PassThroughSoapFaults booleanValue="false"/>
                                <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyGetServiceName?requestID=${request.http.parameter.requestID}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="serviceName"/>
                                <L7p:SamlAssertionVersion intValue="2"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="Got info from localhost, service is ${servicename.mainpart}"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtzZXJ2aWNlTmFtZS5tYWlucGFydH0="/>
                                <L7p:VariableToSet stringValue="ServiceName"/>
                            </L7p:SetVariable>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${ServiceName}"/>
                                    <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="CONTAINS"/>
                                    <L7p:RightValue stringValue="No such request ID"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <wsp:All wsp:Usage="Required">
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+PC9TRVJWSUNFX05BTUU+PFJFUVVFU1RfU1RBVFVTPjxTVEFUVVM+RVJST1I8L1NUQVRVUz48U1RBVFVTX0NPREU+LTE8L1NUQVRVU19DT0RFPjxTVEFUVVNfTUVTU0FHRT5ObyBTdWNoIFJlcXVlc3QgSUQ8L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                                    <L7p:EarlyResponse booleanValue="true"/>
                                    <L7p:ResponseStatus stringValue="400"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:FalseAssertion/>
                                </wsp:All>
                            </wsp:OneOrMore>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8c2VyOkdldFJlc3BvbnNlPg0KICAgICAgICAgPHNlcnZpY2VOYW1lPiR7c2VydmljZW5hbWV9PC9zZXJ2aWNlTmFtZT4NCiAgICAgICAgIDxyZXF1ZXN0SWQ+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlcXVlc3RJRH08L3JlcXVlc3RJZD4NCiAgICAgIDwvc2VyOkdldFJlc3BvbnNlPg0KICAgPC9zb2FwZW52OkJvZHk+DQo8L3NvYXBlbnY6RW52ZWxvcGU+"/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="XMLRequest"/>
                            </L7p:SetVariable>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="${xmlrequest.mainpart}"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="Routing thru http://localhost:8080/LegacyImported/${serviceName}"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:HttpRoutingAssertion>
                                <L7p:MaxRetries intValue="0"/>
                                <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${serviceName}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="finalResponse"/>
                                <L7p:SamlAssertionVersion intValue="2"/>
                            </L7p:HttpRoutingAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="etaForDivision"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/eta/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="setting receiveTimeout"/>
                                    </L7p:AuditDetailAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${request.http.parameter.timeout}"/>

                                    <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item cardinality="included">
                                    <L7p:Max intValue="-1"/>
                                    <L7p:Min intValue="1"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnRpbWVvdXR9"/>
                                    <L7p:VariableToSet stringValue="receiveTimeout"/>
                                    </L7p:SetVariable>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${gateway.partner.configuration.receive.delay.defaultTimeout}"/>

                                    <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item stringLength="included">
                                    <L7p:Max intValue="-1"/>
                                    <L7p:Min intValue="1"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtnYXRld2F5LnBhcnRuZXIuY29uZmlndXJhdGlvbi5yZWNlaXZlLmRlbGF5LmRlZmF1bHRUaW1lb3V0fQ=="/>
                                    <L7p:VariableToSet stringValue="receiveTimeout"/>
                                    </L7p:SetVariable>
                                    </wsp:All>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="MzA="/>
                                    <L7p:VariableToSet stringValue="receiveTimeout"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// setting receiveTimeout"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:OneOrMore>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Finished setting receiveTimeout to ${receiveTimeout}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="setting etafordivision"/>
                                    </L7p:AuditDetailAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtldGFGb3JEaXZpc2lvbi5yZXN1bHR9"/>
                                    <L7p:VariableToSet stringValue="etaForDivision"/>
                                    </L7p:SetVariable>
                                    </wsp:All>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="MTA="/>
                                    <L7p:VariableToSet stringValue="etaForDivision"/>
                                    </L7p:SetVariable>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// setting etaForDivision"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                    </wsp:OneOrMore>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Finished setting etaForDivision to ${etaForDivision}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PGVtcHR5Lz4="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="delayDataMsg"/>
                                    </L7p:SetVariable>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtnYXRld2F5LnBhcnRuZXIuY29uZmlndXJhdGlvbi5ldGFEaXZpc29yfQ=="/>
                                    <L7p:VariableToSet stringValue="etaDivisor"/>
                                    </L7p:SetVariable>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Doing XSL on ${DelayDatamsg.mainpart}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:XslTransformation>
                                    <L7p:Direction intValue="-1"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    <L7p:OtherTargetMessageVariable stringValue="delayDataMsg"/>
                                    <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output indent="no" omit-xml-declaration="yes"/>

<xsl:param name="iterationCountMax" select="'Not Set'"/>
<xsl:param name="receiveTimeout" select="'Not Set'"/>

<xsl:variable name="iterationCount">
  <xsl:choose>
    <xsl:when test="$iterationCountMax > $receiveTimeout">
      <xsl:value-of select="$receiveTimeout"/>
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="$iterationCountMax"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:variable>

<xsl:variable name="delayTime">
  <xsl:choose>
    <xsl:when test="$iterationCountMax > $receiveTimeout">
      <xsl:value-of select="1000"/>
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="ceiling($receiveTimeout * 1000 div $iterationCountMax)"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:variable>

<xsl:template match="/">
  <xsl:element name="delayData">
    <xsl:element name="delayTime">
      <xsl:value-of select="$delayTime"/>
    </xsl:element>
    <xsl:element name="iterators">
      <xsl:call-template name="appendValue">
        <xsl:with-param name="i" select="1"/>
      </xsl:call-template>
    </xsl:element>
  </xsl:element>
</xsl:template>

<xsl:template name="appendValue">
  <xsl:param name="i"/>
  
  <xsl:if test="$i &lt;= $iterationCount">
    <xsl:if test="$i > 1">
      <xsl:value-of select="','"/>
    </xsl:if>
    <xsl:value-of select="$i"/>
    <xsl:call-template name="appendValue">
      <xsl:with-param name="i" select="$i + 1"/>
    </xsl:call-template>
  </xsl:if>
</xsl:template>
</xsl:stylesheet>]]></L7p:Document>
                                    </L7p:ResourceInfo>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:TransformName stringValue=""/>
                                    <L7p:XsltVersion stringValue="1.0"/>
                                    </L7p:XslTransformation>
                                    <L7p:XslTransformation>
                                    <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// it will iterate (timeout/(eta/divisor)) with delaytime of (eta/divisor)"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:AssertionComment>
                                    <L7p:Direction intValue="-1"/>
                                    <L7p:OtherTargetMessageVariable stringValue="delayDataMsg"/>
                                    <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output indent="no" omit-xml-declaration="yes"/>

<!-- these are only placeholders-->
<xsl:param name="etaForDivision" select="placeholder"/>
<xsl:param name="etaDivisor" select="placeholder"/>
<xsl:param name="receiveTimeout" select="placeholder"/>
<!-- end of  placeholders-->

<xsl:variable name="iterationCount">
      <xsl:value-of select="ceiling($receiveTimeout div ($etaForDivision div $etaDivisor))"/>
</xsl:variable>

<xsl:variable name="delayTime">
      <xsl:value-of select="ceiling($etaForDivision div $etaDivisor)"/>
</xsl:variable>

<xsl:template match="/">
  <xsl:element name="delayData">
    <xsl:element name="delayTime">
      <xsl:value-of select="$delayTime"/>
    </xsl:element>
    <xsl:element name="iterators">
      <xsl:call-template name="appendValue">
        <xsl:with-param name="i" select="1"/>
      </xsl:call-template>
    </xsl:element>
  </xsl:element>
</xsl:template>

<xsl:template name="appendValue">
  <xsl:param name="i"/>
  <xsl:if test="$i &lt;= $iterationCount">
    <xsl:if test="$i > 1">
      <xsl:value-of select="','"/>
    </xsl:if>
    <xsl:value-of select="$i"/>
    <xsl:call-template name="appendValue">
      <xsl:with-param name="i" select="$i + 1"/>
    </xsl:call-template>
  </xsl:if>
</xsl:template>
</xsl:stylesheet>]]></L7p:Document>
                                    </L7p:ResourceInfo>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:TransformName stringValue=""/>
                                    <L7p:XsltVersion stringValue="1.0"/>
                                    </L7p:XslTransformation>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="finished XSL  on ${DelayDatamsg.mainpart}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="delayTime"/>
                                    <L7p:XmlMsgSrc stringValue="delayDataMsg"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/delayData/delayTime/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtkZWxheVRpbWUucmVzdWx0fQ=="/>
                                    <L7p:VariableToSet stringValue="delayTime"/>
                                    </L7p:SetVariable>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Delay time value is  ${Delaytime}"/>
                                    </L7p:AuditDetailAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="iteratorString"/>
                                    <L7p:XmlMsgSrc stringValue="delayDataMsg"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/delayData/iterators/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="MQ=="/>
                                    <L7p:VariableToSet stringValue="iteratorString.result"/>
                                    </L7p:SetVariable>
                                    </wsp:OneOrMore>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtpdGVyYXRvclN0cmluZy5yZXN1bHR9"/>
                                    <L7p:VariableToSet stringValue="iteratorString"/>
                                    </L7p:SetVariable>
                                    <L7p:Split>
                                    <L7p:InputVariable stringValue="iteratorString"/>
                                    <L7p:OutputVariable stringValue="iterators"/>
                                    </L7p:Split>
                                    <L7p:ForEachLoop
                                    L7p:Usage="Required"
                                    loopVariable="iterators" variablePrefix="i">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:Delay>
                                    <L7p:DelayMilliSec stringValue="${delayTime}"/>
                                    </L7p:Delay>
                                    <L7p:HttpRoutingAssertion>
                                    <L7p:MaxRetries intValue="0"/>
                                    <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${serviceName}"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="finalResponse"/>

                                    <L7p:SamlAssertionVersion intValue="2"/>
                                    </L7p:HttpRoutingAssertion>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:ResponseXpathAssertion>

                                    <L7p:VariablePrefix stringValue="eta"/>
                                    <L7p:XmlMsgSrc stringValue="finalResponse"/>

                                    <L7p:XpathExpression xpathExpressionValue="included">

                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/response/eta/text()"/>

                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>

                                    <L7p:key stringValue="ser"/>

                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    <L7p:entry>

                                    <L7p:key stringValue="s"/>

                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>

                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaptureVar stringValue="eta"/>

                                    <L7p:CaseInsensitive booleanValue="true"/>
                                    <L7p:Enabled booleanValue="false"/>

                                    <L7p:OtherTargetMessageVariable stringValue="finalresponse"/>
                                    <L7p:Regex stringValue="&lt;eta>(\d+)&lt;/eta>"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="JHtmaW5hbHJlc3BvbnNlLnJlc3VsdH0="/>

                                    <L7p:EarlyResponse booleanValue="true"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:ResponseXpathAssertion>

                                    <L7p:VariablePrefix stringValue=""/>
                                    <L7p:XmlMsgSrc stringValue="finalResponse"/>

                                    <L7p:XpathExpression xpathExpressionValue="included">

                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/response/text()"/>

                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>

                                    <L7p:key stringValue="ser"/>

                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    <L7p:entry>

                                    <L7p:key stringValue="s"/>

                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>

                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:HardcodedResponse>

                                    <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0="/>

                                    <L7p:EarlyResponse booleanValue="true"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="dHJ1ZQ=="/>

                                    <L7p:VariableToSet stringValue="responseReceived"/>
                                    </L7p:SetVariable>
                                    <L7p:SetVariable>

                                    <L7p:Base64Expression stringValue="dHJ1ZQ=="/>

                                    <L7p:VariableToSet stringValue="i.break"/>
                                    </L7p:SetVariable>
                                    </wsp:All>
                                    </wsp:OneOrMore>
                                    </wsp:All>
                                    </L7p:ForEachLoop>
                                    <wsp:OneOrMore wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${responseReceived}"/>
                                    <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="true"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPgogICA8c29hcGVudjpIZWFkZXIvPgogICA8c29hcGVudjpCb2R5PgogICAgICA8c2VyOkxlZ2FjeUludm9jYXRpb25SZXNwb25zZT4KICAgICAgICAgPGV0YT4ke2V0YVsxXX08L2V0YT4KICAgICAgICAgPHJlcXVlc3Qtbm90LWZvdW5kPlRpbWUgT3V0PC9yZXF1ZXN0LW5vdC1mb3VuZD4KICAgICAgICAgPHJlcXVlc3RJZD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIucmVxdWVzdElEfTwvcmVxdWVzdElkPgogICAgICA8L3NlcjpMZWdhY3lJbnZvY2F0aW9uUmVzcG9uc2U+CiAgIDwvc29hcGVudjpCb2R5Pgo8L3NvYXBlbnY6RW52ZWxvcGU+Cg=="/>
                                    </L7p:HardcodedResponse>
                                    </wsp:OneOrMore>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// if there is an ETA come in here"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <wsp:All wsp:Usage="Required">
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue=""/>
                                    <L7p:XmlMsgSrc stringValue="finalResponse"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/response/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="ser"/>
                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0="/>
                                    <L7p:EarlyResponse booleanValue="true"/>
                                    <L7p:ResponseContentType stringValue="text/plain; charset=UTF-8"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="JHtmaW5hbFJlc3BvbnNlLm1haW5wYXJ0fQ=="/>
                                    <L7p:EarlyResponse booleanValue="true"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// if the response has no ETA, return it simply"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                            </wsp:OneOrMore>
                        </wsp:All>
                        <L7p:HardcodedResponse>
                            <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtzZXJ2aWNlbmFtZS5tYWlucGFydH08L1NFUlZJQ0VfTkFNRT48UkVRVUVTVF9TVEFUVVM+PFNUQVRVUz5FUlJPUjwvU1RBVFVTPjxTVEFUVVNfQ09ERT4tMTwvU1RBVFVTX0NPREU+PFNUQVRVU19NRVNTQUdFPlVuYWJsZSB0byByZXRyaWV2ZSByZXNwb25zZS48L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                        </L7p:HardcodedResponse>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="Receive Action"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.parameters.action}"/>
                        <L7p:FailIfVariableNotFound booleanValue="false"/>
                        <L7p:MultivaluedComparison multivaluedComparison="FIRST"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="GetStatus"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="Choose if requestid is not there or it is there or else, just could not perform the request"/>
                    </L7p:AuditDetailAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="Found request ID"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.requestID}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+PC9TRVJWSUNFX05BTUU+PFJFUVVFU1RfU1RBVFVTPjxTVEFUVVM+RVJST1I8L1NUQVRVUz48U1RBVFVTX0NPREU+LTE8L1NUQVRVU19DT0RFPjxTVEFUVVNfTUVTU0FHRT5QYXJhbWV0ZXIgcmVxdWVzdElEIGlzIHJlcXVpcmVkLjwvU1RBVFVTX01FU1NBR0U+PC9SRVFVRVNUX1NUQVRVUz48L0lGX1JFUExZPg=="/>
                                <L7p:EarlyResponse booleanValue="true"/>
                            </L7p:HardcodedResponse>
                        </wsp:All>
                        <wsp:OneOrMore wsp:Usage="Required">
                            <wsp:All wsp:Usage="Required">
                                <L7p:HttpRoutingAssertion>
                                    <L7p:PassThroughSoapFaults booleanValue="false"/>
                                    <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyGetServiceName?requestID=${request.http.parameter.requestID}"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="serviceName"/>
                                    <L7p:SamlAssertionVersion intValue="2"/>
                                </L7p:HttpRoutingAssertion>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtzZXJ2aWNlTmFtZS5tYWlucGFydH0="/>
                                    <L7p:VariableToSet stringValue="ServiceName"/>
                                </L7p:SetVariable>
                                <wsp:OneOrMore wsp:Usage="Required">
                                    <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${ServiceName}"/>
                                    <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="CONTAINS"/>
                                    <L7p:RightValue stringValue="No such request ID"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                    </L7p:ComparisonAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+PC9TRVJWSUNFX05BTUU+PFJFUVVFU1RfU1RBVFVTPjxTVEFUVVM+RVJST1I8L1NUQVRVUz48U1RBVFVTX0NPREU+LTE8L1NUQVRVU19DT0RFPjxTVEFUVVNfTUVTU0FHRT5ObyBTdWNoIFJlcXVlc3QgSUQ8L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                                    <L7p:EarlyResponse booleanValue="true"/>
                                    <L7p:ResponseStatus stringValue="400"/>
                                    </L7p:HardcodedResponse>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Found Service name for that request"/>
                                    </L7p:AuditDetailAssertion>
                                </wsp:OneOrMore>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8c2VyOkdldFJlc3BvbnNlPg0KICAgICAgICAgPHNlcnZpY2VOYW1lPiR7c2VydmljZU5hbWV9PC9zZXJ2aWNlTmFtZT4NCiAgICAgICAgIDxyZXF1ZXN0SWQ+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnJlcXVlc3RJZH08L3JlcXVlc3RJZD4NCiAgICAgIDwvc2VyOkdldFJlc3BvbnNlPg0KICAgPC9zb2FwZW52OkJvZHk+DQo8L3NvYXBlbnY6RW52ZWxvcGU+"/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="XMLRequest"/>
                                </L7p:SetVariable>
                                <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Routing through service"/>
                                </L7p:AuditDetailAssertion>
                                <L7p:HttpRoutingAssertion>
                                    <L7p:PassThroughSoapFaults booleanValue="false"/>
                                    <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${servicename}"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="finalResponse"/>
                                    <L7p:SamlAssertionVersion intValue="2"/>
                                </L7p:HttpRoutingAssertion>
                                <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Finished Routing through service"/>
                                </L7p:AuditDetailAssertion>
                                <wsp:OneOrMore wsp:Usage="Required">
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="See if there is an error"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:Regex>
                                    <L7p:AutoTarget booleanValue="false"/>
                                    <L7p:CaseInsensitive booleanValue="true"/>

                                    <L7p:OtherTargetMessageVariable stringValue="finalResponse.mainpart"/>
                                    <L7p:Regex stringValue="&lt;/SERVICE_NAME>.*&lt;REQUEST_STATUS>.*&lt;STATUS>ERROR"/>
                                    <L7p:RegexName stringValue="Checking if there is an ERROR at highest level"/>
                                    <L7p:Replacement stringValue=""/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:Regex>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="JHtmaW5hbFJlc3BvbnNlLm1haW5wYXJ0fQ=="/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                    <wsp:All wsp:Usage="Required">
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="There is no error, writing out answer"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPgogIDxSRVFVRVNUX1NUQVRVUz4KICAgIDxTVEFUVVM+U1VDQ0VTUzwvU1RBVFVTPiAKICAgIDxTVEFUVVNfQ09ERT4zPC9TVEFUVVNfQ09ERT4gCiAgICA8U1RBVFVTX01FU1NBR0UgLz4gCiAgPC9SRVFVRVNUX1NUQVRVUz4KICA8UkVRVUVTVF9JRD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIucmVxdWVzdElEfTwvUkVRVUVTVF9JRD4gCjwvSUZfUkVQTFk+"/>
                                    </L7p:HardcodedResponse>
                                    </wsp:All>
                                </wsp:OneOrMore>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// check if servicename exists"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:All>
                            <L7p:HardcodedResponse>
                                <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlcnZpY2VOYW1lfTwvU0VSVklDRV9OQU1FPjxSRVFVRVNUX1NUQVRVUz48U1RBVFVTPkVSUk9SPC9TVEFUVVM+PFNUQVRVU19DT0RFPi0xPC9TVEFUVVNfQ09ERT48U1RBVFVTX01FU1NBR0U+Q291bGQgbm90IHBlcmZvcm0gcmVxdWVzdCAyLjwvU1RBVFVTX01FU1NBR0U+PC9SRVFVRVNUX1NUQVRVUz48L0lGX1JFUExZPg=="/>
                            </L7p:HardcodedResponse>
                        </wsp:OneOrMore>
                        <L7p:HardcodedResponse>
                            <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlcnZpY2VOYW1lfTwvU0VSVklDRV9OQU1FPjxSRVFVRVNUX1NUQVRVUz48U1RBVFVTPkVSUk9SPC9TVEFUVVM+PFNUQVRVU19DT0RFPi0xPC9TVEFUVVNfQ09ERT48U1RBVFVTX01FU1NBR0U+Q291bGQgbm90IHBlcmZvcm0gcmVxdWVzdC48L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                        </L7p:HardcodedResponse>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="GetStatus action"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.parameters.action}"/>
                        <L7p:FailIfVariableNotFound booleanValue="false"/>
                        <L7p:MultivaluedComparison multivaluedComparison="FIRST"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="Resend"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.requestID}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:HttpRoutingAssertion>
                                <L7p:PassThroughSoapFaults booleanValue="false"/>
                                <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyGetServiceName?requestID=${request.http.parameter.requestID}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="serviceName"/>
                                <L7p:SamlAssertionVersion intValue="2"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtzZXJ2aWNlTmFtZS5tYWlucGFydH0="/>
                                <L7p:VariableToSet stringValue="ServiceName"/>
                            </L7p:SetVariable>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${ServiceName}"/>
                                <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="CONTAINS"/>
                                    <L7p:RightValue stringValue="No such request ID"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Requesting a receive to itself"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:HttpRoutingAssertion>
                                    <L7p:Enabled booleanValue="false"/>
                                    <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/?action=receive&amp;requestID=${http.request.parameter.requestID}"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="responseMsg1"/>
                                    <L7p:SamlAssertionVersion intValue="2"/>
                                    <L7p:Timeout stringValue="300000"/>
                                    </L7p:HttpRoutingAssertion>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="Getting response"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="${responsemsg1.mainpart}"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtyZXNwb25zZU1zZzEubWFpbnBhcnR9"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    <L7p:VariableToSet stringValue="responseOut"/>
                                    </L7p:SetVariable>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValueReference="inline"><![CDATA[SELECT 	REQ_XML_REQUEST, 
	REQ_ORIGIN, 
	REQ_ORIGINATOR, 
	REQ_ORIGINAPP,
	REQ_CORRELATION_ID,
	REQ_CANCEL_TIMEOUT
FROM REQUESTS WHERE REQ_ID=${request.http.parameter.requestID}]]></L7p:Detail>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:JdbcQuery>
                                    <L7p:ConnectionName stringValue="Tracer Database"/>
                                    <L7p:MaxRecords intValue="1"/>
                                    <L7p:SqlQuery stringValueReference="inline"><![CDATA[SELECT 	REQ_XML_REQUEST, 
	REQ_ORIGIN, 
	REQ_ORIGINATOR, 
	REQ_ORIGINAPP,
	REQ_CORRELATION_ID,
	REQ_CANCEL_TIMEOUT
FROM REQUESTS WHERE REQ_ID=${request.http.parameter.requestID}]]></L7p:SqlQuery>
                                    </L7p:JdbcQuery>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="${jdbcQuery.req_xml_request}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkucmVxX3htbF9yZXF1ZXN0fQ=="/>
                                    <L7p:VariableToSet stringValue="responseOut"/>
                                    </L7p:SetVariable>
                                    <L7p:Include>
                                    <L7p:PolicyGuid stringValue="9b24fba0-6ba9-4c94-9d2b-04f611c4ff46"/>
                                    </L7p:Include>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8c2VyOkludm9rZT4NCiAgICAgICAgIDxzZXJ2aWNlTmFtZT4ke3NlcnZpY2VOYW1lfTwvc2VydmljZU5hbWU+DQogICAgICAgICA8aW52b2NhdGlvblBhcmFtZXRlcnM+DQogICAgICAgICAgICA8YXN5bmM+ZmFsc2U8L2FzeW5jPg0KICAgICAgICAgICAgPGFyZ3VtZW50cz4NCiAgICAgICAgICAgICAgIDxpbnB1dD4ke3Jlc3BvbnNlT3V0fTwvaW5wdXQ+DQogICAgICAgICAgICA8L2FyZ3VtZW50cz4NCiAgICAgICAgICAgIDxyZXFPcmlnaW4+JHtqZGJjUXVlcnkucmVxX29yaWdpbn08L3JlcU9yaWdpbj4NCiAgICAgICAgICAgIDxyZXFPcmlnaW5BcHA+JHtqZGJjUXVlcnkucmVxX29yaWdpbkFwcH08L3JlcU9yaWdpbkFwcD4NCiAgICAgICAgICAgIDxyZXFPcmlnaW5hdG9yPiR7amRiY1F1ZXJ5LnJlcV9vcmlnaW5hdG9yfTwvcmVxT3JpZ2luYXRvcj4NCiAgICAgICAgICAgIDxjb25zdW1lclRpbWVvdXQ+JHtqZGJjUXVlcnkucmVxX2NhbmNlbF90aW1lb3V0fTwvY29uc3VtZXJUaW1lb3V0Pg0KICAgICAgICAgICAgPGNvcnJlbGF0aW9uSWQ+JHtqZGJjUXVlcnkucmVxX2NvcnJlbGF0aW9uX2lkfTwvY29ycmVsYXRpb25JZD4NCiAgICAgICAgICAgIDxmb3JjZVN5bmM+dHJ1ZTwvZm9yY2VTeW5jPg0KICAgICAgICAgPC9pbnZvY2F0aW9uUGFyYW1ldGVycz4NCiAgICAgIDwvc2VyOkludm9rZT4NCiAgIDwvc29hcGVudjpCb2R5Pg0KPC9zb2FwZW52OkVudmVsb3BlPg=="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="XMLRequest"/>
                                    </L7p:SetVariable>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="${XmlRequest.mainpart}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:HttpRoutingAssertion>
                                    <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${serviceName}"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="responseMsg"/>
                                    <L7p:SamlAssertionVersion intValue="2"/>
                                    <L7p:Timeout stringValue="300000"/>
                                    </L7p:HttpRoutingAssertion>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue=""/>
                                    <L7p:XmlMsgSrc stringValue="responseMsg"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/response/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="ser"/>
                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:RemoteCacheStore>
                                    <L7p:CacheDisplayName stringValue="${request.http.parameter.requestID}-${gateway.partner.environment}-response"/>
                                    <L7p:CacheEntryKey stringValue="${request.http.parameter.requestID}-${gateway.partner.environment}-response"/>
                                    <L7p:MaxEntryAge stringValue="30000"/>
                                    <L7p:MaxEntrySizeBytes stringValue="100000"/>
                                    <L7p:OtherTargetMessageVariable stringValue="responseXpath.result"/>
                                    <L7p:RemoteCacheId longValue="11567104"/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:RemoteCacheStore>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0="/>
                                    </L7p:HardcodedResponse>
                                    <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// using itself's receive action to get what it needs."/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                    </L7p:assertionComment>
                                </wsp:All>
                                <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtzZXJ2aWNlbmFtZS5tYWlucGFydH08L1NFUlZJQ0VfTkFNRT48UkVRVUVTVF9TVEFUVVM+PFNUQVRVUz5FUlJPUjwvU1RBVFVTPjxTVEFUVVNfQ09ERT4tMTwvU1RBVFVTX0NPREU+PFNUQVRVU19NRVNTQUdFPlVuYWJsZSB0byByZXRyaWV2ZSByZXNwb25zZSAyLjwvU1RBVFVTX01FU1NBR0U+PC9SRVFVRVNUX1NUQVRVUz48L0lGX1JFUExZPg=="/>
                                </L7p:HardcodedResponse>
                            </wsp:OneOrMore>
                        </wsp:All>
                        <L7p:HardcodedResponse>
                            <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtzZXJ2aWNlbmFtZS5tYWlucGFydH08L1NFUlZJQ0VfTkFNRT48UkVRVUVTVF9TVEFUVVM+PFNUQVRVUz5FUlJPUjwvU1RBVFVTPjxTVEFUVVNfQ09ERT4tMTwvU1RBVFVTX0NPREU+PFNUQVRVU19NRVNTQUdFPlVuYWJsZSB0byByZXRyaWV2ZSByZXNwb25zZS48L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                        </L7p:HardcodedResponse>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="Resend action"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.parameters.action}"/>
                        <L7p:FailIfVariableNotFound booleanValue="false"/>
                        <L7p:MultivaluedComparison multivaluedComparison="FIRST"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item dataType="included">
                                <L7p:Type variableDataType="string"/>
                            </L7p:item>
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="Retry"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValueReference="inline"><![CDATA[--- Retry Parameters:
request.http.method=${request.http.method} 
action: "${request.http.parameter.action}"
timeout: "${request.http.parameter.timeout}"
xmlRequest: "${request.http.parameter.xmlRequest}"
serviceName: "${request.http.parameter.serviceName}"
reqOrigin: "${request.http.parameter.reqOrigin}"
reqOriginApp: "${request.http.parameter.reqOriginApp}"
reqOriginator: "${request.http.parameter.reqOriginator}"
requestID: "${request.http.parameter.requestID}"]]></L7p:Detail>
                    </L7p:AuditDetailAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${request.http.parameter.requestID}"/>
                                <L7p:FailIfVariableNotFound booleanValue="false"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:HttpRoutingAssertion>
                                <L7p:PassThroughSoapFaults booleanValue="false"/>
                                <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyGetServiceName?requestID=${request.http.parameter.requestID}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="serviceName"/>
                                <L7p:SamlAssertionVersion intValue="2"/>
                            </L7p:HttpRoutingAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="JHtzZXJ2aWNlTmFtZS5tYWlucGFydH0="/>
                                <L7p:VariableToSet stringValue="ServiceName"/>
                            </L7p:SetVariable>
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="^^^^^^^^^^^^ ${ServiceName}"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${ServiceName}"/>
                                <L7p:MultivaluedComparison multivaluedComparison="FAIL"/>
                                <L7p:Operator operatorNull="null"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="CONTAINS"/>
                                    <L7p:RightValue stringValue="No such request ID"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:JdbcQuery>
                                    <L7p:ConnectionName stringValue="${config.connection}"/>
                                    <L7p:Enabled booleanValue="false"/>
                                    <L7p:MaxRecords intValue="1"/>
                                    <L7p:SqlQuery stringValueReference="inline"><![CDATA[SELECT 	REQ_XML_REQUEST, 
	REQ_ORIGIN, 
	REQ_ORIGINATOR, 
	REQ_ORIGINAPP,
	REQ_CORRELATION_ID,
	REQ_CANCEL_TIMEOUT
FROM REQUESTS WHERE REQ_ID=${request.http.parameter.requestID}]]></L7p:SqlQuery>
                                    </L7p:JdbcQuery>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtqZGJjUXVlcnkucmVxX3htbF9yZXF1ZXN0fQ=="/>
                                    <L7p:VariableToSet stringValue="responseOut"/>
                                    </L7p:SetVariable>
                                    <L7p:Include>
                                    <L7p:PolicyGuid stringValue="9b24fba0-6ba9-4c94-9d2b-04f611c4ff46"/>
                                    </L7p:Include>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnNlcj0iaHR0cDovL3d3dy5vcmFuZ2UuY28uaWwvc2VydmljZXMiPg0KICAgPHNvYXBlbnY6SGVhZGVyLz4NCiAgIDxzb2FwZW52OkJvZHk+DQogICAgICA8c2VyOkludm9rZT4NCiAgICAgICAgIDxzZXJ2aWNlTmFtZT4ke3NlcnZpY2VOYW1lfTwvc2VydmljZU5hbWU+DQoJPHJlcXVlc3RJZD4ke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIucmVxdWVzdElEfTwvcmVxdWVzdElkPg0KICAgICAgICAgPGludm9jYXRpb25QYXJhbWV0ZXJzPg0KICAgICAgICAgICAgPGFzeW5jPmZhbHNlPC9hc3luYz4NCiAgICAgICAgICAgIDxhcmd1bWVudHM+DQogICAgICAgICAgICAgICA8aW5wdXQ+JHtyZXNwb25zZU91dH08L2lucHV0Pg0KICAgICAgICAgICAgPC9hcmd1bWVudHM+DQogICAgICAgICAgICA8cmVxT3JpZ2luPiR7amRiY1F1ZXJ5LnJlcV9vcmlnaW59PC9yZXFPcmlnaW4+DQogICAgICAgICAgICA8cmVxT3JpZ2luQXBwPiR7amRiY1F1ZXJ5LnJlcV9vcmlnaW5BcHB9PC9yZXFPcmlnaW5BcHA+DQogICAgICAgICAgICA8cmVxT3JpZ2luYXRvcj4ke2pkYmNRdWVyeS5yZXFfb3JpZ2luYXRvcn08L3JlcU9yaWdpbmF0b3I+DQogICAgICAgICAgICA8Y29uc3VtZXJUaW1lb3V0PiR7amRiY1F1ZXJ5LnJlcV9jYW5jZWxfdGltZW91dH08L2NvbnN1bWVyVGltZW91dD4NCiAgICAgICAgICAgIDxjb3JyZWxhdGlvbklkPiR7amRiY1F1ZXJ5LnJlcV9jb3JyZWxhdGlvbl9pZH08L2NvcnJlbGF0aW9uSWQ+DQogICAgICAgICAgICA8Zm9yY2VTeW5jPnRydWU8L2ZvcmNlU3luYz4NCiAgICAgICAgIDwvaW52b2NhdGlvblBhcmFtZXRlcnM+DQogICAgICA8L3NlcjpJbnZva2U+DQogICA8L3NvYXBlbnY6Qm9keT4NCjwvc29hcGVudjpFbnZlbG9wZT4="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="XMLRequest"/>
                                    </L7p:SetVariable>
                                    <L7p:AuditDetailAssertion>
                                    <L7p:Detail stringValue="XMLRequest.mainpart = ${XMLRequest.mainpart}"/>
                                    </L7p:AuditDetailAssertion>
                                    <L7p:HttpRoutingAssertion>
                                    <L7p:ProtectedServiceUrl stringValue="http://localhost:8080/LegacyImported/${serviceName}"/>
                                    <L7p:ProxyPassword stringValueNull="null"/>
                                    <L7p:ProxyUsername stringValueNull="null"/>
                                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:RequestHeaderRules>
                                    <L7p:RequestMsgSrc stringValue="XMLRequest"/>
                                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                    </L7p:RequestParamRules>
                                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                    </L7p:ResponseHeaderRules>
                                    <L7p:ResponseMsgDest stringValue="responseMsg"/>
                                    <L7p:SamlAssertionVersion intValue="2"/>
                                    <L7p:Timeout stringValue="300000"/>
                                    </L7p:HttpRoutingAssertion>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue=""/>
                                    <L7p:XmlMsgSrc stringValue="responseMsg"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/s:Envelope/s:Body/ser:LegacyInvocationResponse/response/text()"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="ser"/>
                                    <L7p:value stringValue="http://www.orange.co.il/services"/>
                                    </L7p:entry>
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:RemoteCacheStore>
                                    <L7p:CacheDisplayName stringValue="${request.http.parameter.requestID}-${gateway.partner.environment}-response"/>
                                    <L7p:CacheEntryKey stringValue="${request.http.parameter.requestID}-${gateway.partner.environment}-response"/>
                                    <L7p:MaxEntryAge stringValue="30000"/>
                                    <L7p:MaxEntrySizeBytes stringValue="100000"/>
                                    <L7p:OtherTargetMessageVariable stringValue="responseXpath.result"/>
                                    <L7p:RemoteCacheId longValue="11567104"/>
                                    <L7p:Target target="OTHER"/>
                                    </L7p:RemoteCacheStore>
                                    <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="JHtyZXNwb25zZVhwYXRoLnJlc3VsdH0="/>
                                    </L7p:HardcodedResponse>
                                </wsp:All>
                                <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtzZXJ2aWNlbmFtZX08L1NFUlZJQ0VfTkFNRT48UkVRVUVTVF9TVEFUVVM+PFNUQVRVUz5FUlJPUjwvU1RBVFVTPjxTVEFUVVNfQ09ERT4tMTwvU1RBVFVTX0NPREU+PFNUQVRVU19NRVNTQUdFPlVuYWJsZSB0byByZXRyaWV2ZSByZXNwb25zZSAyLjwvU1RBVFVTX01FU1NBR0U+PC9SRVFVRVNUX1NUQVRVUz48L0lGX1JFUExZPg=="/>
                                </L7p:HardcodedResponse>
                            </wsp:OneOrMore>
                        </wsp:All>
                        <L7p:HardcodedResponse>
                            <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtzZXJ2aWNlbmFtZS5tYWlucGFydH08L1NFUlZJQ0VfTkFNRT48UkVRVUVTVF9TVEFUVVM+PFNUQVRVUz5FUlJPUjwvU1RBVFVTPjxTVEFUVVNfQ09ERT4tMTwvU1RBVFVTX0NPREU+PFNUQVRVU19NRVNTQUdFPlVuYWJsZSB0byByZXRyaWV2ZSByZXNwb25zZS48L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                        </L7p:HardcodedResponse>
                    </wsp:OneOrMore>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="Retry action"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <L7p:HardcodedResponse>
                    <L7p:AssertionComment assertionComment="included">
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="LEFT.COMMENT"/>
                                <L7p:value stringValue="ELSE: "/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:AssertionComment>
                    <L7p:Base64ResponseBody stringValue="PElGX1JFUExZPjxTRVJWSUNFX05BTUU+JHtyZXF1ZXN0Lmh0dHAucGFyYW1ldGVyLnNlcnZpY2VOYW1lfTwvU0VSVklDRV9OQU1FPjxSRVFVRVNUX1NUQVRVUz48U1RBVFVTPkVSUk9SPC9TVEFUVVM+PFNUQVRVU19DT0RFPi0xPC9TVEFUVVNfQ09ERT48U1RBVFVTX01FU1NBR0U+Tm8gdmFsaWQgQWN0aW9uIGRlZmluZWQ8L1NUQVRVU19NRVNTQUdFPjwvUkVRVUVTVF9TVEFUVVM+PC9JRl9SRVBMWT4="/>
                </L7p:HardcodedResponse>
            </wsp:OneOrMore>
        </wsp:All>
    </wsp:Policy>
</exp:Export>
